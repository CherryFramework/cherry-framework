!function(e,a){"use strict";a.utilites.namespace("ui_elements.media"),a.ui_elements.media={init:function(e){var i=this;a.status.document_ready?i.render(e):a.variable.$document.on("ready",i.render(e))},render:function(a){var i=e(".upload-button",a),r=i.parents(".cherry-ui-media-wrap"),t={input:e(".cherry-upload-input",r),img_holder:e(".cherry-upload-preview",r),title_text:i.data("title"),multiple:i.data("multi-upload"),library_type:i.data("library-type")},s=wp.media.frames.file_frame=wp.media({title:t.title_text,button:{text:t.title_text},multiple:t.multiple,library:{type:t.library_type}});i.on("click",function(){return s.on("select",function(){var a=s.state().get("selection").toJSON(),i=0,r="",c=e(".cherry-all-images-wrap",t.img_holder),l="",o="";for(t.multiple&&(r=t.input.val(),o=",",l=c.html());a[i];){var d=a[i],u=d.id,p=d.mime,m="",h="";switch(p){case"image/jpeg":case"image/png":case"image/gif":void 0!==d.sizes&&(m=d.sizes.thumbnail?d.sizes.thumbnail.url:d.sizes.full.url),h='<img  src="'+m+'" alt="" data-img-attr="'+u+'">';break;case"image/x-icon":h='<span class="dashicons dashicons-format-image"></span>';break;case"video/mpeg":case"video/mp4":case"video/quicktime":case"video/webm":case"video/ogg":h='<span class="dashicons dashicons-format-video"></span>';break;case"audio/mpeg":case"audio/wav":case"audio/ogg":h='<span class="dashicons dashicons-format-audio"></span>'}l+='<div class="cherry-image-wrap"><div class="inner"><div class="preview-holder"  data-id-attr="'+u+'"><div class="centered">'+h+'</div></div><a class="cherry-remove-image" href="#"><i class="dashicons dashicons-no"></i></a><span class="title">'+d.title+"</span></div></div>",r+=o+u,i++}t.input.val(r.replace(/(^,)/,"")).trigger("change"),c.html(l),e(".cherry-remove-image").on("click",function(){return n(e(this)),!1})}).open(),!1}),jQuery(".cherry-remove-image",a).on("click",function(){return n(jQuery(this)),!1});var n=function(e){var a=e.parents(".cherry-ui-media-wrap"),i=jQuery(".cherry-upload-input",a),r=e.parent().parent(".cherry-image-wrap"),t=jQuery(".preview-holder",r).data("id-attr"),s=i.attr("value"),n=new RegExp(""+t+"(,*)","i");s=s.replace(n,""),s=s.replace(/(,$)/,""),i.attr({value:s}).trigger("change"),r.remove()};jQuery(".cherry-all-images-wrap",a).sortable({items:"div.cherry-image-wrap",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"cherry-media-thumb-sortable-placeholder",start:function(){},stop:function(){},update:function(){var e="";jQuery(".cherry-image-wrap",this).each(function(){var a=jQuery(".preview-holder",this).data("id-attr");e=e+a+","}),e=e.substr(0,e.lastIndexOf(",")),jQuery(this).parent().siblings(".cherry-element-wrap").find("input.cherry-upload-input").val(e).trigger("change")}})}},e(window).on("cherry-ui-elements-init",function(e,i){a.ui_elements.media.init(i.target)})}(jQuery,window.CherryJsCore);